<!DOCTYPE html>
<html>
<head>
  <title>ORACOLOUS - CONSTELLATION VIEWER - MAKER</title>
  <meta charset="UTF-8">
</head>
<body>
  <style>
  #byte_content {
    margin: 5px 0;
    max-height: 100px;
    overflow-y: auto;
    overflow-x: hidden;
  }
  #byte_range { margin-top: 5px; }
</style>
THIS IS THE TOOL I CREATED AND USED TO CREATE THE SET OF DATA - DIRECTLY USING CELESTIA INSTALLATION FILES.<br/>
<div id="step1">
STEP 1 -> Read stars.dat<br/>
<input type="file" id="starsfile" name="starsfile" />
  <button onclick="readStarsDat();">Read stars.dat</button></div>

<div id="step2" style="display:none">
STEP 2 -> Read starsnames.dat<br/>
<input type="file" id="starsnamesfile" name="starsnamesfile" />
  <button onclick="readStarsNamesDat();">read starsnames.dat</button></div>

<div id="step3" style="display:none">
STEP 3 -> Read asterism.dat<br/>
<input type="file" id="asterismfile" name="asterismfile" />
<button onclick="readAsterismDat();">read asterism.dat</button></div>

<div id="step4" style="display:none">
STEP 4 -> Generate viewer.dat<br/>
	<button onclick="generateViewer();">generate viewer</button></div>

<div id="step5" style="display:none">
STEP 5 -> Save output<br/>
	<textarea id="outputjson"></textarea>
	<button onclick="saveOutput();">save output</button></div>
<script>
  window.HAY={};HAY.stars={length:0};HAY.names={};
  function readStarsDat(){var files=document.getElementById('starsfile').files;
    if (!files.length) {alert('Please select a file!');return;}
    var file=files[0];var reader = new FileReader();reader.onloadend = function(evt) {	  
      if (evt.target.readyState == FileReader.DONE) {
		var BB=evt.target.result;var NN;var AA;var n=1;var max=BB.byteLength-21;var len=0;  
		for(var b=0;n<(max/20);b+=20){
			//CC=[BB[b+15],BB[b+14],BB[b+13],BB[b+12],BB[b+11],BB[b+10],BB[b+9],BB[b+8],BB[b+7],BB[b+6],BB[b+5],BB[b+4]];
			NN=new Int32Array(BB,b,4);AA=new Float32Array(BB,b+4,12);
			HAY.stars[NN[0]]=[AA[0],AA[1],AA[2]];n++;HAY.stars.length++;
	}document.getElementById('step2').style.display='block';}	};
    var blob = file.slice(14, file.size);
    reader.readAsArrayBuffer(blob);}
	
  function readStarsNamesDat(){var files=document.getElementById('starsnamesfile').files;
    if (!files.length) {alert('Please select a file!');return;}
    var file=files[0];var reader=new FileReader();reader.onloadend=function(evt){	  
      if (evt.target.readyState == FileReader.DONE) {
		var NAMES=evt.target.result.split('\n');var t='';var m;
		for(var n=0;n<NAMES.length;n++){
			t=NAMES[n].split(':');
			for(m=1;m<t.length;m++){HAY.names[t[m].toLowerCase()]=t[0]}
		}
        document.getElementById('step3').style.display='block';}};
    var blob = file.slice(0, file.size);
    reader.readAsText(blob);
  }
  
  function readAsterismDat(){var files=document.getElementById('asterismfile').files;
    if (!files.length) {alert('Please select a file!');return;}
    var file=files[0];var reader=new FileReader();reader.onloadend=function(evt){	  
      if (evt.target.readyState == FileReader.DONE) { 
		window.ASTERISMTEXT=evt.target.result
		.replace(/Alpha/g,'ALF')
		.replace(/Beta/g,'BET')
		.replace(/Gamma/g,'GAM')
		.replace(/Delta/g,'DEL')
		.replace(/Epsilon/g,'EPS')
		.replace(/Iota/g,'IOT')
		.replace(/Kappa/g,'KAP')
		.replace(/Lambda/g,'LAM')
		.replace(/Omega/g,'OME')
		.replace(/Omicron/g,'OMI')
		.replace(/Sigma/g,'SIG')
		.replace(/Theta/g,'TET')
		.replace(/Upsilon/g,'UPS')
		.replace(/Zeta/g,'ZET')		
		.replace(/\n\n/g,'\n').replace(/\n\n/g,'\n').replace(/] /g,']')
		.replace(/"\n\[/g,'":[')
		.replace(/]\n]/g,']],\n')
		.replace(/\[ "/g,'["')
		.replace(/" ]/g,'"]')
		.replace(/]\n\[/g,'],\n[')
		.replace(/]\n\[/g,'],\n[')
		.replace(/  /g,' ')
		.replace(/" "/g,'","')
		.replace(/"\n "/g,'","')
		.replace(/]\[/g,'],[');
		window.ASTERISMTEXT='HAY.asterism={'+window.ASTERISMTEXT+'};';
		eval(ASTERISMTEXT);
        document.getElementById('step4').style.display='block';}};
    var blob = file.slice(0, file.size);
    reader.readAsText(blob);
  }
  function generateViewer(){
	var OUTOUTOUT={};
	var ALL=["Aquarius","Aries","Cancer","Capricornus","Corona Australis","Corona Borealis","Crux","Gemini","Leo","Libra","Orion","Pisces","Sagittarius","Scorpius","Taurus","Ursa Major","Ursa Minor","Virgo"];
	//var ALL=["Andromeda","Antlia","Apus","Aquarius","Aquila","Ara","Aries","Auriga","BoÃ¶tes","Caelum","Camelopardalis","Cancer","Canes Venatici","Canis Major","Canis Minor","Capricornus","Carina","Cassiopeia","Centaurus","Cepheus","Cetus","Chamaeleon","Circinus","Columba","Coma Berenices","Corona Australis","Corona Borealis","Corvus","Crater","Crux","Cygnus","Delphinus","Dorado","Draco","Equuleus","Eridanus","Fornax","Gemini","Grus","Hercules","Horologium","Hydra","Hydrus","Indus","Lacerta","Leo","Leo Minor","Lepus","Libra","Lupus","Lynx","Lyra","Mensa","Microscopium","Monoceros","Musca","Norma","Octans","Ophiuchus","Orion","Pavo","Pegasus","Perseus","Phoenix","Pictor","Pisces","Piscis Austrinus","Puppis","Pyxis","Reticulum","Sagitta","Sagittarius","Scorpius","Sculptor","Scutum","Serpens Caput","Serpens Cauda","Sextans","Taurus","Telescopium","Triangulum","Triangulum Australe","Tucana","Ursa Major","Ursa Minor","Vela","Virgo","Volans","Vulpecula"];
	var CC,VV,O;var C=0;var V=0;var S=0;
	for(C=0;C<ALL.length;C++){var k=ALL[C];
		CC=HAY.asterism[k];OUTOUTOUT[k]={N:k,L:[]};
		for(V=0;V<CC.length;V++){
			OUTOUTOUT[k].L[V]=[];
			for(S=0;S<CC[V].length;S++){try{O=HAY.stars[HAY.names[CC[V][S].toLowerCase()]];
				OUTOUTOUT[k].L[V][S]=O;
				if(!O){console.log('-'+k+'-'+V+'-'+S+'-'+CC[V][S].toLowerCase());}
			}catch(ex){console.log('-'+k+'-'+V+'-'+S+'-'+CC[V][S].toLowerCase());throw ex;}}
		}
	};document.getElementById('outputjson').value=JSON.stringify(OUTOUTOUT);document.getElementById('step5').style.display='block';
  };
</script>
</body>
</html>
